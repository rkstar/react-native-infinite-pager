{"version":3,"sources":["index.tsx"],"names":["React","useState","useImperativeHandle","useCallback","useRef","StyleSheet","Animated","useAnimatedStyle","useSharedValue","withSpring","useDerivedValue","useAnimatedReaction","runOnJS","Gesture","GestureDetector","pageInterpolatorCube","pageInterpolatorSlide","pageInterpolatorStack","pageInterpolatorTurnIn","Preset","PageInterpolators","SLIDE","CUBE","STACK","TURN_IN","DEFAULT_ANIMATION_CONFIG","damping","mass","stiffness","overshootClamping","restSpeedThreshold","restDisplacementThreshold","InfinitePager","vertical","PageComponent","pageCallbackNode","onPageChange","pageBuffer","style","pageWrapperStyle","minIndex","Infinity","maxIndex","simultaneousGestures","gesturesDisabled","animationConfig","renderPage","flingVelocity","preset","pageInterpolator","ref","pageWidth","pageHeight","pageSize","translateX","translateY","translate","curIndex","setCurIndex","pageAnimInternal","pageAnim","pageInterpolatorRef","current","curIndexRef","animCfgRef","setPage","index","options","updatedTranslate","value","animated","animCfg","incrementPage","decrementPage","pageIndices","Array","map","_","i","bufferIndex","onPageChangeInternal","pg","Math","round","cur","prev","startTranslate","panGesture","Pan","onBegin","onUpdate","evt","evtTranslate","translationY","translationX","rawVal","page","onEnd","evtVelocity","velocityY","velocityX","isFling","abs","velocityModifier","Object","assign","enabled","Simultaneous","nativeEvent","layout","width","height","pageIndex","PageWrapper","memo","isActive","isAdjacentToActive","translation","focusAnim","animStyle","isInactivePageBeforeInit","_pageWidth","_pageHeight","console","warn","Error","styles","pageWrapper","activePage","pageWidthAnim","pageHeightAnim","forwardRef","create","left","right","top","bottom","position"],"mappings":"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","sourcesContent":["import React, {\n  useState,\n  useImperativeHandle,\n  useCallback,\n  useRef,\n} from \"react\";\nimport { StyleProp, StyleSheet, ViewStyle } from \"react-native\";\nimport Animated, {\n  useAnimatedStyle,\n  useSharedValue,\n  withSpring,\n  useDerivedValue,\n  useAnimatedReaction,\n  runOnJS,\n  WithSpringConfig,\n} from \"react-native-reanimated\";\nimport {\n  ComposedGesture,\n  Gesture,\n  GestureDetector,\n  GestureType,\n} from \"react-native-gesture-handler\";\nimport {\n  defaultPageInterpolator,\n  pageInterpolatorCube,\n  pageInterpolatorSlide,\n  pageInterpolatorStack,\n  pageInterpolatorTurnIn,\n} from \"./pageInterpolators\";\n\nexport enum Preset {\n  SLIDE = \"slide\",\n  CUBE = \"cube\",\n  STACK = \"stack\",\n  TURN_IN = \"turn-in\",\n}\n\nconst PageInterpolators = {\n  [Preset.SLIDE]: pageInterpolatorSlide,\n  [Preset.CUBE]: pageInterpolatorCube,\n  [Preset.STACK]: pageInterpolatorStack,\n  [Preset.TURN_IN]: pageInterpolatorTurnIn,\n};\n\nexport const DEFAULT_ANIMATION_CONFIG: WithSpringConfig = {\n  damping: 20,\n  mass: 0.2,\n  stiffness: 100,\n  overshootClamping: false,\n  restSpeedThreshold: 0.2,\n  restDisplacementThreshold: 0.2,\n};\n\ntype PageProps = {\n  index: number;\n  focusAnim: Animated.DerivedValue<number>;\n  isActive: boolean;\n  isAdjacentToActive: boolean;\n  pageWidthAnim: Animated.SharedValue<number>;\n  pageHeightAnim: Animated.SharedValue<number>;\n  pageAnim: Animated.SharedValue<number>;\n};\ntype PageComponentType = (props: PageProps) => JSX.Element | null;\n\ntype AnyStyle = StyleProp<ViewStyle> | ReturnType<typeof useAnimatedStyle>;\n\ntype Props = {\n  vertical?: boolean;\n  PageComponent?:\n    | PageComponentType\n    | React.MemoExoticComponent<PageComponentType>;\n  renderPage?: PageComponentType;\n  pageCallbackNode?: Animated.SharedValue<number>;\n  onPageChange?: (page: number) => void;\n  pageBuffer?: number; // number of pages to render on either side of active page\n  style?: AnyStyle;\n  pageWrapperStyle?: AnyStyle;\n  pageInterpolator?: typeof defaultPageInterpolator;\n  minIndex?: number;\n  maxIndex?: number;\n  simultaneousGestures?: (ComposedGesture | GestureType)[];\n  gesturesDisabled?: boolean;\n  animationConfig?: Partial<WithSpringConfig>;\n  flingVelocity?: number;\n  preset?: Preset;\n};\n\ntype ImperativeApiOptions = {\n  animated?: boolean;\n};\n\nexport type InfinitePagerImperativeApi = {\n  setPage: (index: number, options: ImperativeApiOptions) => void;\n  incrementPage: (options: ImperativeApiOptions) => void;\n  decrementPage: (options: ImperativeApiOptions) => void;\n};\n\nfunction InfinitePager(\n  {\n    vertical = false,\n    PageComponent,\n    pageCallbackNode,\n    onPageChange,\n    pageBuffer = 1,\n    style,\n    pageWrapperStyle,\n    minIndex = -Infinity,\n    maxIndex = Infinity,\n    simultaneousGestures = [],\n    gesturesDisabled,\n    animationConfig = {},\n    renderPage,\n    flingVelocity = 500,\n    preset = Preset.SLIDE,\n    pageInterpolator = PageInterpolators[preset],\n  }: Props,\n  ref: React.ForwardedRef<InfinitePagerImperativeApi>\n) {\n  const pageWidth = useSharedValue(0);\n  const pageHeight = useSharedValue(0);\n  const pageSize = vertical ? pageHeight : pageWidth;\n\n  const translateX = useSharedValue(0);\n  const translateY = useSharedValue(0);\n  const translate = vertical ? translateY : translateX;\n\n  const [curIndex, setCurIndex] = useState(0);\n  const pageAnimInternal = useSharedValue(0);\n  const pageAnim = pageCallbackNode || pageAnimInternal;\n\n  const pageInterpolatorRef = useRef(pageInterpolator);\n  pageInterpolatorRef.current = pageInterpolator;\n\n  const curIndexRef = useRef(curIndex);\n  curIndexRef.current = curIndex;\n\n  const animCfgRef = useRef(animationConfig);\n  animCfgRef.current = animationConfig;\n\n  const setPage = useCallback(\n    (index: number, options: ImperativeApiOptions = {}) => {\n      const updatedTranslate = index * pageSize.value * -1;\n      if (options.animated) {\n        const animCfg = {\n          ...DEFAULT_ANIMATION_CONFIG,\n          ...animCfgRef.current,\n        };\n\n        translate.value = withSpring(updatedTranslate, animCfg);\n      } else {\n        translate.value = updatedTranslate;\n      }\n    },\n    [pageSize, translate]\n  );\n\n  useImperativeHandle(\n    ref,\n    () => ({\n      setPage,\n      incrementPage: (options?: ImperativeApiOptions) => {\n        setPage(curIndexRef.current + 1, options);\n      },\n      decrementPage: (options?: ImperativeApiOptions) => {\n        setPage(curIndexRef.current - 1, options);\n      },\n    }),\n    [setPage]\n  );\n\n  const pageIndices = [...Array(pageBuffer * 2 + 1)].map((_, i) => {\n    const bufferIndex = i - pageBuffer;\n    return curIndex - bufferIndex;\n  });\n\n  useDerivedValue(() => {\n    if (pageSize.value) {\n      pageAnim.value = (translate.value / pageSize.value) * -1;\n    }\n  }, [pageSize, pageAnim, translate]);\n\n  function onPageChangeInternal(pg: number) {\n    onPageChange?.(pg);\n    setCurIndex(pg);\n  }\n\n  useAnimatedReaction(\n    () => {\n      return Math.round(pageAnim.value);\n    },\n    (cur, prev) => {\n      if (cur !== prev) {\n        runOnJS(onPageChangeInternal)(cur);\n      }\n    },\n    []\n  );\n\n  const startTranslate = useSharedValue(0);\n\n  const panGesture = Gesture.Pan()\n    .onBegin(() => {\n      startTranslate.value = translate.value;\n    })\n    .onUpdate((evt) => {\n      const evtTranslate = vertical ? evt.translationY : evt.translationX;\n\n      const rawVal = startTranslate.value + evtTranslate;\n      const page = -rawVal / pageSize.value;\n      if (page >= minIndex && page <= maxIndex) {\n        translate.value = rawVal;\n      }\n    })\n    .onEnd((evt) => {\n      const evtVelocity = vertical ? evt.velocityY : evt.velocityX;\n      const isFling = Math.abs(evtVelocity) > flingVelocity;\n      let velocityModifier = isFling ? pageSize.value / 2 : 0;\n      if (evtVelocity < 0) velocityModifier *= -1;\n      let page =\n        -1 * Math.round((translate.value + velocityModifier) / pageSize.value);\n      if (page < minIndex) page = minIndex;\n      if (page > maxIndex) page = maxIndex;\n\n      const animCfg = Object.assign(\n        {},\n        DEFAULT_ANIMATION_CONFIG,\n        animCfgRef.current\n      );\n\n      translate.value = withSpring(-page * pageSize.value, animCfg);\n    })\n    .enabled(!gesturesDisabled);\n\n  return (\n    <GestureDetector\n      gesture={Gesture.Simultaneous(panGesture, ...simultaneousGestures)}\n    >\n      <Animated.View\n        style={style}\n        onLayout={({ nativeEvent: { layout } }) => {\n          pageWidth.value = layout.width;\n          pageHeight.value = layout.height;\n        }}\n      >\n        {pageIndices.map((pageIndex) => {\n          return (\n            <PageWrapper\n              key={`page-provider-wrapper-${pageIndex}`}\n              vertical={vertical}\n              pageAnim={pageAnim}\n              index={pageIndex}\n              pageWidth={pageWidth}\n              pageHeight={pageHeight}\n              isActive={pageIndex === curIndex}\n              isAdjacentToActive={Math.abs(pageIndex - curIndex) === 1}\n              PageComponent={PageComponent}\n              renderPage={renderPage}\n              style={pageWrapperStyle}\n              pageInterpolatorRef={pageInterpolatorRef}\n              pageBuffer={pageBuffer}\n            />\n          );\n        })}\n      </Animated.View>\n    </GestureDetector>\n  );\n}\n\ntype PageWrapperProps = {\n  vertical: boolean;\n  pageAnim: Animated.SharedValue<number>;\n  index: number;\n  pageWidth: Animated.SharedValue<number>;\n  pageHeight: Animated.SharedValue<number>;\n  PageComponent?: PageComponentType;\n  renderPage?: PageComponentType;\n  isActive: boolean;\n  isAdjacentToActive: boolean;\n  style?: AnyStyle;\n  pageInterpolatorRef: React.MutableRefObject<typeof defaultPageInterpolator>;\n  pageBuffer: number;\n};\n\nexport type PageInterpolatorParams = {\n  index: number;\n  vertical: boolean;\n  focusAnim: Animated.DerivedValue<number>;\n  pageAnim: Animated.DerivedValue<number>;\n  pageWidth: Animated.SharedValue<number>;\n  pageHeight: Animated.SharedValue<number>;\n  pageBuffer: number;\n};\n\nconst PageWrapper = React.memo(\n  ({\n    index,\n    pageAnim,\n    pageWidth,\n    pageHeight,\n    vertical,\n    PageComponent,\n    renderPage,\n    isActive,\n    isAdjacentToActive,\n    style,\n    pageInterpolatorRef,\n    pageBuffer,\n  }: PageWrapperProps) => {\n    const pageSize = vertical ? pageHeight : pageWidth;\n\n    const translation = useDerivedValue(() => {\n      const translateX = (index - pageAnim.value) * pageSize.value;\n      return translateX;\n    }, []);\n\n    const focusAnim = useDerivedValue(() => {\n      if (!pageSize.value) return 99999;\n      return translation.value / pageSize.value;\n    }, []);\n\n    const animStyle = useAnimatedStyle(() => {\n      // Short circuit page interpolation to prevent buggy initial values due to possible race condition:\n      // https://github.com/software-mansion/react-native-reanimated/issues/2571\n      const isInactivePageBeforeInit = index !== 0 && !pageSize.value;\n      const _pageWidth = isInactivePageBeforeInit ? focusAnim : pageWidth;\n      const _pageHeight = isInactivePageBeforeInit ? focusAnim : pageHeight;\n      return pageInterpolatorRef.current({\n        focusAnim,\n        pageAnim,\n        pageWidth: _pageWidth,\n        pageHeight: _pageHeight,\n        index,\n        vertical,\n        pageBuffer,\n      });\n    }, [\n      pageWidth,\n      pageHeight,\n      pageAnim,\n      index,\n      translation,\n      vertical,\n      pageBuffer,\n    ]);\n\n    if (PageComponent && renderPage) {\n      console.warn(\n        \"PageComponent and renderPage both defined, defaulting to PageComponent\"\n      );\n    }\n\n    if (!PageComponent && !renderPage) {\n      throw new Error(\"Either PageComponent or renderPage must be defined.\");\n    }\n\n    return (\n      <Animated.View\n        style={[\n          style,\n          styles.pageWrapper,\n          animStyle,\n          isActive && styles.activePage,\n        ]}\n      >\n        {PageComponent ? (\n          <PageComponent\n            index={index}\n            isActive={isActive}\n            isAdjacentToActive={isAdjacentToActive}\n            focusAnim={focusAnim}\n            pageWidthAnim={pageWidth}\n            pageHeightAnim={pageHeight}\n            pageAnim={pageAnim}\n          />\n        ) : (\n          renderPage?.({\n            index,\n            isActive,\n            isAdjacentToActive,\n            focusAnim,\n            pageWidthAnim: pageWidth,\n            pageHeightAnim: pageHeight,\n            pageAnim,\n          })\n        )}\n      </Animated.View>\n    );\n  }\n);\n\nexport default React.memo(React.forwardRef(InfinitePager));\n\nconst styles = StyleSheet.create({\n  pageWrapper: {\n    left: 0,\n    right: 0,\n    top: 0,\n    bottom: 0,\n    position: \"absolute\",\n  },\n  activePage: {\n    position: \"relative\",\n  },\n});\n"]}